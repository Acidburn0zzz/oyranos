IF(${CMAKE_SYSTEM_NAME} MATCHES "Linux")
   SET( XCM_LINUX_CFILES
	   XcmDDC.c
	   XcmDummy.c
      )
   SET(HAVE_LINUX TRUE)
ENDIF()
IF( X11_FOUND )
   SET( XCM_X11_CFILES
	   Xcm.c
	   XcmEvents.c
      )
   SET(HAVE_X11 TRUE)
ENDIF()

CONFIGURE_FILE (
	"${CMAKE_CURRENT_SOURCE_DIR}/../include/X11/Xcm/XcmVersion.h.in"
	"${CMAKE_BINARY_DIR}/src/include/X11/Xcm/XcmVersion.h"
	@ONLY
   )

SET( CFILES_OBJECT_CONFIG_PUBLIC
	XcmEdidParse.c
	${XCM_LINUX_CFILES}
	${XCM_X11_CFILES}
   )
SET( CFILES_OBJECT_CONFIG_PUBLIC ${CFILES_OBJECT_CONFIG_PUBLIC} PARENT_SCOPE )
SET( CFILES_OBJECT_CONFIG
	${CFILES_OBJECT_CONFIG_PUBLIC}
   )


SET( SOURCES ${CFILES_OBJECT_CONFIG} )

SET( EXTRA_LIBS ${EXTRA_LIBS} ${XINERAMA_LIBRARIES} ${XRANDR_LIBRARIES}
                ${XMU_LIBRARIES}
                ${XFIXES_LIBRARIES} ${X11_LIBRARIES} )

INCLUDE_DIRECTORIES (
       	${CMAKE_SOURCE_DIR}/libxcm/include/X11/Xcm
        ${CMAKE_BINARY_DIR}/src/include/X11/Xcm/
	)

IF(APPLE)
ENDIF (APPLE)

ADD_LIBRARY( xcm-static STATIC ${SOURCES} )
TARGET_LINK_LIBRARIES (
   xcm-static
   ${EXTRA_LIBS} )
