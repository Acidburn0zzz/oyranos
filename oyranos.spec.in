Summary: Colour Management System
Name: oyranos
License: BSD
Group: Development/Libraries
URL: http://www.oyranos.org
Vendor: Kai-Uwe Behrmann
#BuildArch: %{_arch}
#%ifos linux
#Prereq: oyranos-icc-RGB oyranos-icc-lcmsLAB oyranos-icc-ECI-RGB oyranos-icc-Cineaon oyranos-icc-printing oyranos-target-fogra oyranos-target-npes
#%endif 
BuildRoot: %{_tmppath}/%{name}-root
Prefix:    %{_prefix}
Requires:  elektra


%if 0%{?suse_version} > 0
BuildRequires:     gcc-c++ gettext doxygen graphviz pkgconfig    libpng-devel libjpeg libjpeg-devel xorg-x11-Mesa xorg-x11-Mesa-devel libtiff-devel libxml2-devel liblcms-devel cups-devel
#elektra-devel
%endif
%if 0 < 0%{?suse_version} && 0%{?suse_version} > 910
#BuildRequires: gcc-c++ gettext doxygen fltk-threaded fltk-threaded-devel xorg-x11 xorg-x11-devel xorg-x11-Mesa-devel  pkgconfig libpng-devel libjpeg-devel
BuildRequires:  acl autoconf automake bash bind-utils binutils bison bzip2 coreutils cpio cvs cyrus-sasl diffutils e2fsprogs expat file filesystem findutils flex fontconfig fontconfig-devel freetype2 freetype2-devel gawk gcc gcc-c++ gettext gettext-devel glibc glibc-devel gpm grep groff gzip info less libacl libattr libjpeg libjpeg-devel libpng libpng-devel libtool m4 make man mktemp module-init-tools ncurses ncurses-devel net-tools openssl pam patch perl pkgconfig popt procinfo procps psmisc rcs readline rpm sed strace tar texinfo timezone unzip util-linux zlib zlib-devel
%endif
%if 0 < 0%{?suse_version} && 0%{?suse_version} > 1010
BuildRequires:  Mesa Mesa-devel gcc-c++ gettext graphviz pkgconfig    libpng-devel libjpeg-devel xorg-x11-fonts-devel xorg-x11-libICE xorg-x11-libICE-devel xorg-x11-libSM xorg-x11 xorg-x11-devel xorg-x11-libSM-devel xorg-x11-libX11 xorg-x11-libX11-devel xorg-x11-libXau xorg-x11-libXau-devel xorg-x11-libXdmcp xorg-x11-libXdmcp-devel xorg-x11-libXext xorg-x11-libXext-devel xorg-x11-libXfixes xorg-x11-libXfixes-devel xorg-x11-libXmu xorg-x11-libXmu-devel xorg-x11-libXp xorg-x11-libXp-devel xorg-x11-libXpm xorg-x11-libXpm-devel xorg-x11-libXprintUtil xorg-x11-libXprintUtil-devel xorg-x11-libXrender xorg-x11-libXrender-devel xorg-x11-libXt xorg-x11-libXt-devel xorg-x11-libXv xorg-x11-libXv-devel xorg-x11-libfontenc xorg-x11-libfontenc-devel xorg-x11-libs xorg-x11-libxkbfile xorg-x11-libxkbfile-devel xorg-x11-proto-devel xorg-x11-util-devel xorg-x11-xtrans-devel
%endif
%if 0%{?mandriva_version} > 0
BuildRequires:  Mesa libxorg-x11-devel libxpm4-devel gcc-c++ gettext doxygen graphviz fltk fltk-devel pkgconfig    libpng-devel libjpeg libjpeg-devel  libtiff-devel libxml2-devel liblcms-devel elektra-devel cups-devel
%endif
%if 0%{?fedora_version} > 0
BuildRequires:  Mesa Mesa-devel gcc-c++ gettext doxygen graphviz fltk fltk-devel pkgconfig    libpng-devel libjpeg libjpeg-devel xorg-x11-devel xorg-x11-Mesa-devel libXxf86vm-devel  libtiff-devel libxml2-devel liblcms-devel elektra-devel cups-devel
%endif
%if 0%{?debian_version} > 0
BuildRequires: gcc-c++ gettext doxygen graphviz fltk fltk-devel libpng-devel libjpeg-devel pkgconfig xorg-x11 xorg-x11-devel xorg-x11-Mesa-devel xorg-x11-libXext xorg-x11-libXext-devel  xorg-x11-libXpm xorg-x11-libXpm-devel  libtiff-devel libxml2-devel liblcms-devel elektra-devel cups-devel
%endif



%package      devel
Summary:   Headers, configuration and static libs + documentation
Group:     Development/System
Requires:  %{name}

%package      monitor
Summary:    Oyranos monitor dependent libraries
Group:      Development/Libraries

%package      monitor-nvidia
Summary:    nvidia card support
Group:      Development/Libraries
License: GPL

%package      cups
Summary:    CUPS device support
Group:      Development/Libraries
Requires:   cups

%package      ui-fltk
Summary:    example configuration panel
Group:      Productivity/Graphics/Other
Requires:   fltk

%package      forms-fltk-devel
Summary:    XFORMS subset rendering
Group:      Development/Libraries
Requires:   fltk-devel

%description
Oyranos is a colour management system.
Features:
o configuration for cross application colour agreement 
o plugable and selectable modules (known as CMM's)
o pixel conversions
o profile handling
o named colours
o device profile assignment


Authors:
--------
    Oyranos     Kai-Uwe Behrmann <www.behrmann.name>
    CUPS        Joe Simon <jsimon184@yahoo.com>

used components and libraries with divergine FOSS licenses:
    md5         L. Peter Deutsch
    libXNVCtrl  Nvidia
    FLMM        Matthias Melcher
    lookup3     Bob Jenkins

%description devel
Oyranos is usable to store default profiles and paths and
query for profiles in that paths.
An internal device profile API allowes configuring of a 
profile in X.
The documentation in html format is included.
The object oriented Oyranos API's provide advanced access to
ICC profiles, allow for filtering profile lists and provide
a CMM independent colour conversion API. Single colour lookups 
are supported.
These API's are to be considered for changing very frequently.

%description  monitor
The monitor support libraries of the
Oyranos colour management system.
The monitor profile configuration part.

%description  monitor-nvidia
Display setup tool for the
Oyranos colour management system.
The nvidia EDID configuration part.

%description  cups
CUPS device support for the
Oyranos colour management system.

%description  ui-fltk
The example configuration GUI.
Oyranos is a colour management system.

%description  forms-fltk-devel
Render a Oyranos specific subset of XFORMS in FLTK.
A XFORMS subset is used by Oyranos to describe filter node
options.


%prep
%setup -n %{name}-%{version}

%build
%configure --enable-debug

%install
rm -rf %{buildroot}
make
make DESTDIR=%{buildroot} install-main
rm -fr %{buildroot}/%{_datadir}/doc/%{name}
%find_lang %{name}       # generate a special file list


%clean
rm -rf %{buildroot}

%post
ldconfig

%postun
ldconfig

%files -f %{name}.lang
%defattr(-, root, root)
%doc AUTHORS COPYING ChangeLog README
%{_bindir}/%{name}-config
%{_bindir}/%{name}-policy
%{_libdir}/lib%{name}.so.*
%dir %{_libdir}/colour/
%dir %{_libdir}/%{cmmsubpath}/
%dir %{_libdir}/%{metasubpath}/
%{_libdir}/%{cmmsubpath}/lib%{name}_l*
%{_libdir}/%{cmmsubpath}/lib%{name}_oyra_cmm_module*
%{_libdir}/%{cmmsubpath}/lib%{name}_oicc_cmm_module*
%{_libdir}/%{metasubpath}/lib%{name}_oyIM_cmm_module*
%{_mandir}/man1/%{name}-policy*
%{_datadir}/mime/packages/*.xml
%{pixmapdir}/oyranos_logo.*
%{pixmapdir}/lcms_logo2.png
%{pixmapdir}/application-vnd.iccprofile.png
%{pixmapdir}/text-vnd.cgats.png
%dir %{syscolordir}/
%dir %{syscolordir}/%{settingsdirname}/
%{syscolordir}/%{settingsdirname}/*.policy.xml

%files devel
%defattr(-, root, root)
%doc AUTHORS COPYING ChangeLog README
%{_libdir}/lib%{name}.so
%dir %{_includedir}/%{name}
%{_includedir}/%{name}/icc34.h
%{_includedir}/%{name}/%{name}.h
%{_includedir}/%{name}/%{name}_alpha.h
%{_includedir}/%{name}/%{name}_cmm.h
%{_includedir}/%{name}/%{name}_config.h
%{_includedir}/%{name}/%{name}_definitions.h
%{_includedir}/%{name}/%{name}_icc.h
%{_includedir}/%{name}/%{name}_version.h
%{_libdir}/pkgconfig/*
%{_libdir}/lib%{name}.a
%{_mandir}/man3/%{name}-config.3*
%{_mandir}/man3/%{name}.*
%doc %{name}*.sh
%doc doc/html

%files monitor
%defattr(-, root, root)
%doc AUTHORS COPYING ChangeLog README
%{_bindir}/%{name}-monitor
%dir %{_libdir}/colour/
%dir %{_libdir}/%{cmmsubpath}/
%{_libdir}/%{cmmsubpath}/lib%{name}_oyX1_cmm_module*
%{_libdir}/%{cmmsubpath}/lib%{name}_oydi_cmm_module*
%{_mandir}/man1/%{name}-monitor*

%files monitor-nvidia
%defattr(-, root, root)
%doc AUTHORS COPYING ChangeLog README
%{_bindir}/%{name}-monitor-nvidia

%files cups
%defattr(-, root, root)
%doc AUTHORS COPYING ChangeLog README
%dir %{_libdir}/colour/
%dir %{_libdir}/%{cmmsubpath}/
%{_libdir}/%{cmmsubpath}/lib%{name}_CUPS_cmm_module*

%files ui-fltk
%defattr(-, root, root)
%doc AUTHORS COPYING ChangeLog README
%{_bindir}/%{name}-config-fl*
%{_mandir}/man1/%{name}-config-fltk.1*

%files forms-fltk-devel
%defattr(-, root, root)
%doc AUTHORS COPYING ChangeLog README
%{_libdir}/liboyforms_fltk.a

%changelog
* Fri Oct 16 2009 Kai-Uwe Behrmann
- add oyranos-forms-fltk-devel

* Sun Aug 02 2009 Kai-Uwe Behrmann
- add oicc module
- add CUPS module from Joe Simon and create new RPM from it

* Wed Apr 15 2009 Kai-Uwe Behrmann
- add oydi module

* Thu Oct 02 2008 Kai-Uwe Behrmann
- split display into monitor and monitor-nvidia
- rename panel to ui-fltk

* Fri Jan 25 2008 Kai-Uwe Behrmann
- remove old kdb and cmm registration stuff

* Sat Sep 16 2006 Kai-Uwe Behrmann
- set default policy if no settings are found

* Sat May 28 2005 - Kai-Uwe Behrmann
- packaging

* Tue Apr 21 2005 Kai-Uwe Behrmann
- first release


